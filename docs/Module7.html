
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Launch Files &#8212; ECE495</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="LIDAR" href="Module8.html" />
    <link rel="prev" title="Inertial Measurement Unit" href="Module6.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/beyer_bot.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ECE495</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="welcome.html">
   Welcome and Shortcuts
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  GETTING STARTED
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="getting_started.html">
   Getting Started
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  ROBOT and MASTER SETUP
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="RobotSetup.html">
   Robot Setup
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MODULE 00
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module0.html">
   Intro and GIT
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MODULE 01
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module1.html">
   Robotics Operating System (ROS)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MODULE 02
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module2.html">
   Linux for Robotics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MODULE 03
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module3.html">
   Python3 for Robotics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MODULE 04
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module4.html">
   Driving the Robot
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MODULE 05
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module5.html">
   Custom Messages
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MODULE 06
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module6.html">
   Inertial Measurement Unit
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MODULE 07
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Launch Files
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MODULE 08
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module8.html">
   LIDAR
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MODULE 09
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module9.html">
   Computer Vision
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MODULE 10
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Module10.html">
   Final Project
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Module7.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FModule7.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#purpose">
   Purpose
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#roslaunch">
   roslaunch
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#current-state">
   Current State
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#roslaunch-on-the-robot">
   roslaunch on the Robot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#roslaunch-on-the-master">
   roslaunch on the Master
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-launch-files">
   Running Launch Files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#checkpoint">
   Checkpoint
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleanup">
   Cleanup
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Launch Files</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#purpose">
   Purpose
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#roslaunch">
   roslaunch
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#current-state">
   Current State
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#roslaunch-on-the-robot">
   roslaunch on the Robot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#roslaunch-on-the-master">
   roslaunch on the Master
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-launch-files">
   Running Launch Files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#checkpoint">
   Checkpoint
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleanup">
   Cleanup
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="launch-files">
<h1>Launch Files<a class="headerlink" href="#launch-files" title="Permalink to this headline">¬∂</a></h1>
<hr class="docutils" />
<p><strong>You must open this file as a Jupyter Notebook (link below) to run code</strong></p>
<p><a class="reference external" href="http://localhost:8888/notebooks/Module7_LaunchFile.ipynb">Run this file as an executable Jupyter Notebook</a></p>
<div class="section" id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¬∂</a></h2>
<p>Large applications in robotics typically involve several interconnected ROS nodes, each of which have many parameters. Your current setup is a good example: as you experienced in the IMU lab, you had to open 4 different terminals to run all of the nodes necessary for our system to that point:</p>
<p><strong>Robot:</strong></p>
<ul class="simple">
<li><p>usafabot/usafabot_serial.py</p></li>
<li><p>um7/um7_driver</p></li>
</ul>
<p><strong>Master:</strong></p>
<ul class="simple">
<li><p>roscore</p></li>
<li><p>lab2/controller.py</p></li>
</ul>
<p>This problem is only going to get more complex as we add additional functionality to our robot. As it stands right now, every node requires a separate terminal window and the associated command to run it. Using the <em>roslaunch</em> tool, we can eliminate that administrivia of running each node separately. We will create/edit two launch files to bring up the nodes on the master and robot.</p>
</div>
<div class="section" id="roslaunch">
<h2><a class="reference external" href="http://wiki.ros.org/roslaunch">roslaunch</a><a class="headerlink" href="#roslaunch" title="Permalink to this headline">¬∂</a></h2>
<p>The <em>roslaunch</em> tool is used to launch multiple ROS nodes locally and remotely via SSH. While it is possible to launch nodes remotely, it becomes challenging when there are parameter or other launch files on a remote system, so we will create a separate launch file for the master and the robot. We can run nodes that we have created, nodes from pre-built packages, and other launch files. The roslaunch tool takes in one or more XML configuration files (with the .launch extension) that specify the parameters to set and nodes to launch.</p>
<p>A launch file is an XML document which specifies:</p>
<ul class="simple">
<li><p>which nodes to execute</p></li>
<li><p>their parameters</p></li>
<li><p>what other files to include</p></li>
</ul>
<p>An XML file stands for Extensible Markup Language (XML). This is a markup language that defines a set of rules for encoding documents in a format that is both human-readable and machine-readable. That isn‚Äôt necessarily important for this class, but you can read about XML on Wikipedia if you are interested.</p>
<p>We will then use a tool embedded within ROS called <em>roslaunch</em> to easily launch multiple nodes or even other launch files.</p>
<p>By convention, we will give our launch files the <em>.launch</em> extension and store them in a <em>launch</em> folder within our package. This isn‚Äôt required, but it is the common convention.</p>
</div>
<div class="section" id="current-state">
<h2>Current State<a class="headerlink" href="#current-state" title="Permalink to this headline">¬∂</a></h2>
<p>In this section we will first use the conventional technique to bring up all of the nodes required for <strong>Lab 2</strong> using the currently understood techniques.</p>
<p>Open a new terminal on your <strong>Master</strong> and start <em>roscore</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>roscore
</pre></div>
</div>
<p>Notice, running *<em>roscore</em> now monopolized that terminal and you can no longer use it for anything else.</p>
<p>Open a new terminal or tab on your <strong>Master</strong> and run the <strong><a class="reference external" href="http://controller.py">controller.py</a></strong> node:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rosrun lab2 controller.py
</pre></div>
</div>
<p>At this point we are done with the master. We only needed to bring up two terminals, however, this is still a relatively simple system in teh grand scheme of things.</p>
<blockquote>
<div><p>üìùÔ∏è <strong>Note:</strong> We did need to keep the terminal with the <strong><a class="reference external" href="http://controller.py">controller.py</a></strong> node open so we can enter commands.</p>
</div></blockquote>
<p>We can now transition to the robot and bring up the required nodes.</p>
<p>Open a new terminal window on the <strong>Master</strong> and use SSH to create a secure shell into the <strong>Robot</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh pi@robotX
</pre></div>
</div>
<p>Utilize the SSH instance to start the <strong>usafabot_serial.py</strong> node:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rosrun usafabot usafabot_serial.py
</pre></div>
</div>
<p>Open a new terminal tab on the <strong>Master</strong> and use SSH to create a secure shell into the robot.</p>
<p>Utilize the SSH connection to start the <strong>um7_driver</strong> node:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rosrun um7 um7_driver _port:<span class="o">=</span>/dev/ttyACM0
</pre></div>
</div>
<blockquote>
<div><p>üìùÔ∏è <strong>Note:</strong> We needed to include and additional parameter for this node to specify the port for the um7 IMU. You will need ot use the port for your particular robot (did you write down the command to display the serial ports from ICE 6?)</p>
</div></blockquote>
<p>Overall you needed 4 terminal windows, including two SSH connections, to bring up this relatively simple system of sensors.</p>
<p>Kill all nodes and roscore.</p>
</div>
<div class="section" id="roslaunch-on-the-robot">
<h2>roslaunch on the Robot<a class="headerlink" href="#roslaunch-on-the-robot" title="Permalink to this headline">¬∂</a></h2>
<p>Navigate to one of the terminals with a secure shell connection to the robot.</p>
<p>Open the <em>robotics.launch</em> file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rosed usafabot robotics.launch
</pre></div>
</div>
<p>At this time, the <em>robotics.launch</em> file includes everything you need to run the robot and more. Let‚Äôs talk about each line of the file:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;`.0?&gt;</span>
</pre></div>
</div>
<p>This line is the XML prolog, which is optional, but enables editors to include proper formatting for an XML file since the extension of a launch file is <em>.launch</em> instead of <em>.xml</em>.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;launch&gt;</span>
    ...
<span class="nt">&lt;/launch&gt;</span>
</pre></div>
</div>
<p>Every launch file opens and closes with the <em>launch</em> root element.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- A urdf file describes the physical configuration of the robot for simulation --&gt;</span>
<span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;robot_description&quot;</span> <span class="na">command=</span><span class="s">&quot;$(find xacro)/xacro &#39;$(find usafabot_description)/urdf/usafabot.urdf.xacro&#39;&quot;</span><span class="nt">/&gt;</span>	

<span class="cm">&lt;!-- A transform that enables rviz to visualize the robot --&gt;</span>
<span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;bot_to_map&quot;</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">args=</span><span class="s">&quot;0 0 0 0 0 0 map base_footprint&quot;</span> <span class="nt">/&gt;</span>

<span class="cm">&lt;!-- Publish robot states --&gt;</span>
<span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;robot_state_publisher&quot;</span> <span class="na">pkg=</span><span class="s">&quot;robot_state_publisher&quot;</span> <span class="na">type=</span><span class="s">&quot;robot_state_publisher&quot;</span> <span class="nt">/&gt;</span>

<span class="cm">&lt;!-- Publish joint transforms --&gt;</span>
<span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;joint_state_publisher&quot;</span> <span class="na">pkg=</span><span class="s">&quot;joint_state_publisher&quot;</span> <span class="na">type=</span><span class="s">&quot;joint_state_publisher&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>These params/nodes are used when visualizing the robot in <em>rviz</em> and <em>Gazebo</em> and provide simulation and navigation capabilities compatible with other ROS packages. Leave them in case you want to use them in future projects. The first line is a comment. If you are interested in learning more about these nodes, see one of your instructors for more details.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- Node to send commands to robot and gets wheel speeds from robot --&gt;</span>
<span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;serial&quot;</span> <span class="na">pkg=</span><span class="s">&quot;usafabot&quot;</span> <span class="na">type=</span><span class="s">&quot;usafabot_serial.py&quot;</span> <span class="nt">/&gt;</span>

<span class="cm">&lt;!-- start the um7 IMU node setting correct port --&gt;</span>
<span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;um7_IMU&quot;</span> <span class="na">pkg=</span><span class="s">&quot;um7&quot;</span> <span class="na">type=</span><span class="s">&quot;um7_driver&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;port&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;/dev/ttyACM1&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/node&gt;</span>

<span class="cm">&lt;!-- make a call to the um7 service to reset gyros, EKF, mag_ref --&gt;</span> 
<span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">&quot;rosservice&quot;</span> <span class="na">type=</span><span class="s">&quot;rosservice&quot;</span> <span class="na">name=</span><span class="s">&quot;reset&quot;</span> <span class="na">args=</span><span class="s">&quot;call --wait /imu/reset true true true&quot;</span><span class="nt">/&gt;</span>

<span class="cm">&lt;!-- call the rplidar launch file --&gt;</span>
<span class="cm">&lt;!--</span>
<span class="cm">&lt;include file=&quot;$(find usafabot)/launch/include/rplidar.launch&quot; /&gt;</span>
<span class="cm">--&gt;</span>
</pre></div>
</div>
<p>The above are the nodes we will use in this course along with one call to a ROS service. Each node includes an opening and closing tag. If there are no parameters (<em>usafabot_serial.py</em>), the tags are <code class="docutils literal notranslate"><span class="pre">&lt;node</span></code> and <code class="docutils literal notranslate"><span class="pre">/&gt;</span></code>. If there are parameters (<em>um7_driver</em>) then you must use the name of the closing element: <code class="docutils literal notranslate"><span class="pre">&lt;node</span></code> and `</node>. Pay attention to this formatting as it has tripped up students in the past. After the opening tag is the name of the node, the package where it is located, and the name of the executable file.</p>
<blockquote>
<div><p>üìùÔ∏è <strong>Note:</strong> The parameter used in the <em>um7_driver</em> node sets the port to connect to the IMU. If your IMU is not connecting you must update the port name in the launch file.</p>
</div></blockquote>
<p>After the <em>um7_driver</em> node is a call to the same service we used during ICE6 to reset the gyros, EKF, and mag_ref. We will no longer need to call the service within the <strong><a class="reference external" href="http://controller.py">controller.py</a></strong> node.</p>
<p>The last line, currently commented out, demonstrates how to launch another launch file. You will use the LIDAR launch file in <strong>Lab 3</strong>.</p>
<p>Close the editor: <code class="docutils literal notranslate"><span class="pre">ctrl+x</span></code></p>
<p>Take a moment to look at the rplidar launch file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rosed usafabot rplidar.launch
</pre></div>
</div>
<p>You will not the launch file is running a single node with a number of parameters. We will discuss these in more details next lab.</p>
<p>Close the editor: <code class="docutils literal notranslate"><span class="pre">ctrl+x</span></code></p>
</div>
<div class="section" id="roslaunch-on-the-master">
<h2>roslaunch on the Master<a class="headerlink" href="#roslaunch-on-the-master" title="Permalink to this headline">¬∂</a></h2>
<p>Navigate to your <strong>lab2</strong> package on the <strong>Master</strong> and create a launch directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">roscd</span> <span class="n">lab2</span>
<span class="n">mkdir</span> <span class="n">launch</span>
<span class="n">cd</span> <span class="n">launch</span>
<span class="n">touch</span> <span class="n">lab2</span><span class="o">.</span><span class="n">launch</span>
</pre></div>
</div>
<p>Open the launch file to edit (I recommend using Thonny).</p>
<p>Now we are going to edit the launch file to bring up the <strong><a class="reference external" href="http://controller.py">controller.py</a></strong> node on the <strong>Master</strong>.</p>
<blockquote>
<div><p>üìùÔ∏è <strong>Note:</strong> <em>roslaunch</em> will look to see if <em>roscore</em> is started. If it is not, it will automatically run <em>roscore</em>.</p>
</div></blockquote>
<p>Add the following to the <strong>lab2.launch</strong> file</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;launch&gt;</span>
	<span class="cm">&lt;!-- node to correlate sensor data and send commands to USAFABot --&gt;</span>
	<span class="nt">&lt;node</span> 
		<span class="na">name=</span><span class="s">&quot;controller&quot;</span> <span class="na">pkg=</span><span class="s">&quot;lab2&quot;</span> <span class="na">type=</span><span class="s">&quot;controller.py&quot;</span>
		<span class="na">output=</span><span class="s">&quot;screen&quot;</span> <span class="na">launch-prefix=</span><span class="s">&quot;xterm -e&quot;</span>
	<span class="nt">/&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</pre></div>
</div>
<blockquote>
<div><p>üìùÔ∏è <strong>Note:</strong> Remember earlier how we reminded you that we need to keep the terminal available for the controller to type commands. By using the two additional parameters <em>screen</em> and <em>launch-prefix</em>, we can ensure the terminal is available for use.</p>
</div></blockquote>
<p>Save and close the launch file.</p>
</div>
<div class="section" id="running-launch-files">
<h2>Running Launch Files<a class="headerlink" href="#running-launch-files" title="Permalink to this headline">¬∂</a></h2>
<p>Browse to a terminal on the <strong>Master</strong> and make and source your workspace:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/master_ws
catkin_make
<span class="nb">source</span> ~/.bashrc
</pre></div>
</div>
<p>Utilize the <em>roslaunch</em> utility to execute the <strong>lab2</strong> launch file on your <strong>Master</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>roslaunch lab2 lab2.launch
</pre></div>
</div>
<p>Open a new terminal and list the running nodes. You should see <em>rosout</em> (<em>roscore</em>) and <em>controller</em>.</p>
<p>Browse to a terminal that has the SSH connection to the <strong>Robot</strong> and utilize the <em>roslaunch</em> utility to execute the <em>robotics.launch</em> file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>roslaunch usafabot robotics.launch
</pre></div>
</div>
<p>In a separate terminal, bring up <strong>rqt_graph</strong>. Your output should look similar to this:</p>
<p><img alt="IMU" src="_images/rqt_graph.png" /></p>
</div>
<div class="section" id="checkpoint">
<h2>Checkpoint<a class="headerlink" href="#checkpoint" title="Permalink to this headline">¬∂</a></h2>
<p>Once complete, get checked off by an instructor showing the output of your <strong>rqt_graph</strong> node.</p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¬∂</a></h2>
<p>There is clearly a lot more we can do with launch files, but this will get you started. You now know how to run nodes, other launch files, and provide parameters to a node using a launch file. I encourage you to visit the ROS tutorials online if you need to do more complex functions with the launch files.</p>
</div>
<div class="section" id="cleanup">
<h2>Cleanup<a class="headerlink" href="#cleanup" title="Permalink to this headline">¬∂</a></h2>
<p>In each terminal window, close the nodes by typing <code class="docutils literal notranslate"><span class="pre">ctrl+c</span></code>. Exit any SSH connections. Shutdown the notebook server by typing <code class="docutils literal notranslate"><span class="pre">ctrl+c</span></code> within the terminal you ran <code class="docutils literal notranslate"><span class="pre">jupyter-notebook</span></code> in. Select ‚Äòy‚Äô.</p>
<p><strong>Ensure roscore is terminated before moving on to the next lesson.</strong></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Module6.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Inertial Measurement Unit</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Module8.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">LIDAR</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Mr. Steven Beyer<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>